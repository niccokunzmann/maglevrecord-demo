maglevrecord-demo
=================

A demo application for maglev record.


keeping track of changes
------------------------



Open 4 command line windows (terminals) in the [project](project) directory.

    cd project
    
Three of them are used to track the changes while you code.

First window to track the file system:

    make watch_files
    
output:

    ./migrations [error opening dir]
    ./app/models

It uses tree to show the models and migrations of the project folder.
    
Second window to see which migrations shall be done:

    make watch_migrations
   
output:

    Already applied all migrations.
    
This calls `bundle exec rake migrate:up?` to show which migrations have to be applied

The third window trackes the changes in your stone, your database.

    make watch_changes
    
output:

    rake migrate:up has to be done first
    
It calls `bundle exec rake migrate:auto?` to show what changes would be written to an automigration generated by `bundle exec rake migrate:auto`.


Reset and Restart
-----------------

If you want to restart you can always do `make clean`. This will

- destroy and restart the stone
- delete the example files

You can do it now. `make watch_changes` and `make watch_migrations` need to be restarted.

Apply All Migrations
--------------------

    bundle exec rake migrate:up
    
This applies all migrations in the `migrations` folder and creates a snapshot of the stone in the stone that no classes are defined yet.

Create a Model Class
--------------------

    make example

This creates a file [`app/models/my_model.rb`](project/.example_model.rb) with a class `MyModel`:

See the ouput of `make watch_files`:

    ./migrations
    ./app/models
    `-- my_model.rb

Automatically the changes will update:

    loaded app/my_model.rb
    loaded app/my_model.rb
    #new class: MyModel
    
You can edit [`app/models/my_model.rb`](project/.example_model.rb) with your favourite editor.


create a migration
------------------

    bundle exec rake migrate:auto

creates a new migration in the migration folder and puts out the migration file:

    loaded app/my_model.rb
    loaded app/my_model.rb
    loaded app/my_model.rb
    ./migrations/migration_2013-05-May-27_12.19.00.rb

See how the file system updates:

    ./migrations
    `-- migration_2013-05-May-27_12.19.00.rb
    ./app/models
    `-- my_model.rb

And the new has to be appiled

    to do: 'fill in description here' from Mon May 27 14:19:00 +0000 2013

Migrations look like this:

    require "maglev_record/migration"
    require "time"
    
    MaglevRecord::Migration.new(Time.parse('Mon May 27 12:19:00 +0000 2013'), 'fill in description here') do
    
      def up
        #new class: MyModel
      end
    
      def down
        # put the code that reverses the code in up here 
        # remove the next line that throws he error 
        raise IrreversibleMigration, 'The migration has no downcode'
      end
    
    end






